<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸŒ¸ å…ƒå®å†™çš„ ğŸ±</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #ffb6c1;
            --secondary: #ffccd5;
            --accent: #b5e6d9;
            --light: #fff9f9;
            --dark: #6a4c93;
            --cat-color: #ff9e6d;
            --cherry-color: #ff6b8b;
        }
        
        body {
            font-family: 'Arial Rounded MT Bold', 'Arial', sans-serif;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 50%, var(--accent) 100%);
            min-height: 100vh;
            padding: 20px 10px 80px;
            position: relative;
            overflow-x: hidden;
        }
        
        /* èƒŒæ™¯å›¾ç‰‡ */
        .background-image {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://images.unsplash.com/photo-1519681393784-d120267933ba?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            opacity: 0.3;
            z-index: -1;
        }
        
        /* è£…é¥°å…ƒç´  */
        .decoration {
            position: fixed;
            z-index: -1;
            opacity: 0.7;
        }
        
        .cat {
            width: 60px;
            height: 60px;
            background-color: var(--cat-color);
            clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
            position: fixed;
            animation: float 8s infinite ease-in-out;
        }
        
        .cherry-blossom {
            width: 40px;
            height: 40px;
            background-color: var(--cherry-color);
            border-radius: 50% 50% 50% 0;
            transform: rotate(45deg);
            position: fixed;
            animation: fall 15s infinite linear;
        }
        
        .brown-tea {
            width: 30px;
            height: 30px;
            background-color: #8b4513;
            border-radius: 50%;
            position: fixed;
            animation: float 12s infinite ease-in-out;
        }
        
        /* åŠ¨ç”» */
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }
        
        @keyframes fall {
            0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }
        
        /* æ ‡é¢˜åŒºåŸŸ */
        .header {
            text-align: center;
            margin-bottom: 25px;
            padding: 15px;
            background-color: rgba(255, 255, 255, 0.85);
            border-radius: 25px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            border: 3px dashed var(--accent);
            position: relative;
            overflow: hidden;
        }
        
        .header h1 {
            color: var(--dark);
            font-size: 1.8rem;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .header p {
            color: #666;
            font-size: 0.9rem;
        }
        
        /* æ§åˆ¶åŒºåŸŸ */
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .primary-btn {
            background-color: var(--cherry-color);
            color: white;
        }
        
        .secondary-btn {
            background-color: var(--accent);
            color: var(--dark);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        
        .btn:active {
            transform: translateY(1px);
        }
        
        /* å›¾ç‰‡ç½‘æ ¼ */
        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .image-item {
            position: relative;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            height: 150px;
            background-color: #f8f8f8;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .image-item:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }
        
        .image-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        
        .image-item.loading {
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        .loading-text {
            color: #aaa;
            font-size: 0.9rem;
        }
        
        /* æ¨¡æ€æ¡†ï¼ˆæ”¾å¤§æŸ¥çœ‹ï¼‰ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal-content {
            max-width: 90%;
            max-height: 90%;
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.2);
        }
        
        .close-modal {
            position: absolute;
            top: 20px;
            right: 30px;
            color: white;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .close-modal:hover {
            color: var(--primary);
        }
        
        /* åŠ è½½æŒ‡ç¤ºå™¨ */
        .loading-indicator {
            text-align: center;
            padding: 20px;
            color: var(--dark);
            font-size: 1.1rem;
            display: none;
        }
        
        .loading-indicator i {
            margin-right: 10px;
            animation: spin 1s infinite linear;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* é¡µè„š */
        .footer {
            text-align: center;
            margin-top: 20px;
            color: var(--dark);
            font-size: 0.9rem;
            padding: 15px;
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 20px;
        }
        
        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 768px) {
            .image-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
                gap: 10px;
            }
            
            .image-item {
                height: 120px;
            }
            
            .header h1 {
                font-size: 1.5rem;
            }
            
            .btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
        }
        
        @media (max-width: 480px) {
            .image-grid {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            }
            
            .image-item {
                height: 100px;
            }
            
            .header h1 {
                font-size: 1.3rem;
            }
        }
        
        /* å›¾ç‰‡è®¡æ•°å™¨ */
        .counter {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.7rem;
        }
        
        /* å›¾ç‰‡ä¿¡æ¯æç¤º */
        .image-info {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
            color: white;
            padding: 8px;
            font-size: 0.8rem;
            transform: translateY(100%);
            transition: transform 0.3s;
        }
        
        .image-item:hover .image-info {
            transform: translateY(0);
        }
    </style>
</head>
<body>
    <!-- èƒŒæ™¯å›¾ç‰‡ -->
    <div class="background-image"></div>
    
    <!-- è£…é¥°å…ƒç´  -->
    <div class="decoration cat" style="top: 10%; left: 5%;"></div>
    <div class="decoration cherry-blossom" style="top: 5%; left: 15%; animation-delay: 2s;"></div>
    <div class="decoration brown-tea" style="top: 15%; right: 10%; animation-delay: 1s;"></div>
    <div class="decoration cat" style="top: 20%; right: 5%; animation-delay: 0.5s;"></div>
    <div class="decoration cherry-blossom" style="bottom: 10%; left: 10%; animation-delay: 3s;"></div>
    <div class="decoration brown-tea" style="bottom: 20%; right: 15%; animation-delay: 2.5s;"></div>
    <div class="decoration cherry-blossom" style="top: 30%; left: 20%; animation-delay: 1.5s;"></div>
    
    <!-- æ ‡é¢˜åŒºåŸŸ -->
    <div class="header">
        <h1>
            <i class="fas fa-cat"></i>
            æ˜¥æ—¥ç¾å›¾æ”¶è—é¦†
            <i class="fas fa-heart"></i>
        </h1>
        <p>æ¯æ¬¡åˆ·æ–°éƒ½ä¼šå±•ç¤º25å¼ ç²¾ç¾çš„äºŒæ¬¡å…ƒä¸é£æ™¯ç¾å›¾ï¼Œç‚¹å‡»å›¾ç‰‡å¯æ”¾å¤§æŸ¥çœ‹åŸå›¾</p>
    </div>
    
    <!-- æ§åˆ¶åŒºåŸŸ -->
    <div class="controls">
        <button class="btn primary-btn" id="refreshBtn">
            <i class="fas fa-sync-alt"></i> åˆ·æ–°ç¾å›¾
        </button>
        <button class="btn secondary-btn" id="themeBtn">
            <i class="fas fa-palette"></i> åˆ‡æ¢ä¸»é¢˜
        </button>
        <button class="btn secondary-btn" id="layoutBtn">
            <i class="fas fa-th-large"></i> åˆ‡æ¢å¸ƒå±€
        </button>
    </div>
    
    <!-- åŠ è½½æŒ‡ç¤ºå™¨ -->
    <div class="loading-indicator" id="loadingIndicator">
        <i class="fas fa-spinner"></i> æ­£åœ¨åŠ è½½ç¾å›¾ä¸­ï¼Œè¯·ç¨å€™...
    </div>
    
    <!-- å›¾ç‰‡ç½‘æ ¼ -->
    <div class="image-grid" id="imageGrid">
        <!-- å›¾ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
    </div>
    
    <!-- æ¨¡æ€æ¡†ï¼ˆæ”¾å¤§æŸ¥çœ‹ï¼‰ -->
    <div class="modal" id="imageModal">
        <span class="close-modal" id="closeModal">&times;</span>
        <img class="modal-content" id="modalImage" alt="æ”¾å¤§å›¾ç‰‡">
    </div>
    
    <!-- é¡µè„š -->
    <div class="footer">
        <p><i class="fas fa-magic"></i> æ¯å¤©éƒ½æœ‰æ–°ç¾å›¾ï¼Œæ²»æ„ˆä½ çš„æ¯ä¸€å¤© | æœ¬é¡µé¢ä½¿ç”¨æ— éœ€APIå¯†é’¥çš„é«˜è´¨é‡å›¾ç‰‡æº</p>
        <p>å·²åŠ è½½ <span id="loadedCount">0</span>/25 å¼ å›¾ç‰‡ | åŠ è½½æ—¶é—´: <span id="loadTime">0</span>ç§’</p>
    </div>

    <script>
        // é«˜è´¨é‡å›¾ç‰‡APIåˆ—è¡¨ï¼ˆæ— éœ€APIå¯†é’¥ï¼‰
        const imageAPIs = [
            // äºŒæ¬¡å…ƒç¾å°‘å¥³å›¾ç‰‡æº
            "https://api.btstu.cn/sjbz/api.php?lx=dongman&format=images",
            "https://api.btstu.cn/sjbz/api.php?lx=meizi&format=images",
            "https://api.r10086.com/img-api.php?type=åŠ¨æ¼«ç»¼åˆ1",
            "https://api.r10086.com/img-api.php?type=åŠ¨æ¼«ç»¼åˆ2",
            "https://api.r10086.com/img-api.php?type=åŠ¨æ¼«ç»¼åˆ3",
            "https://api.r10086.com/img-api.php?type=åŠ¨æ¼«ç»¼åˆ4",
            "https://api.r10086.com/img-api.php?type=åŠ¨æ¼«ç»¼åˆ5",
            "https://api.r10086.com/img-api.php?type=åŠ¨æ¼«ç»¼åˆ6",
            "https://api.r10086.com/img-api.php?type=åŠ¨æ¼«ç»¼åˆ7",
            "https://api.r10086.com/img-api.php?type=åŠ¨æ¼«ç»¼åˆ8",
            
            // é£æ™¯å›¾ç‰‡æº
            "https://api.btstu.cn/sjbz/api.php?lx=fengjing&format=images",
            "https://api.r10086.com/img-api.php?type=é£æ™¯ç³»åˆ—1",
            "https://api.r10086.com/img-api.php?type=é£æ™¯ç³»åˆ—2",
            "https://api.r10086.com/img-api.php?type=é£æ™¯ç³»åˆ—3",
            "https://api.r10086.com/img-api.php?type=é£æ™¯ç³»åˆ—4",
            "https://api.r10086.com/img-api.php?type=é£æ™¯ç³»åˆ—5",
            "https://api.r10086.com/img-api.php?type=é£æ™¯ç³»åˆ—6",
            "https://api.r10086.com/img-api.php?type=é£æ™¯ç³»åˆ—7",
            "https://api.r10086.com/img-api.php?type=é£æ™¯ç³»åˆ—8",
            
            // å…¶ä»–é«˜è´¨é‡å›¾ç‰‡æº
            "https://api.r10086.com/img-api.php?type=ç»¼åˆé£æ™¯1",
            "https://api.r10086.com/img-api.php?type=ç»¼åˆé£æ™¯2",
            "https://picsum.photos/600/800?random=",
            "https://source.unsplash.com/random/600x800?anime",
            "https://source.unsplash.com/random/600x800?landscape",
            "https://source.unsplash.com/random/600x800?nature",
            "https://source.unsplash.com/random/600x800?scenery"
        ];
        
        // çŠ¶æ€å˜é‡
        let currentTheme = 0;
        let currentLayout = 0;
        let loadedImages = 0;
        let startTime = 0;
        let imagePromises = [];
        
        // ä¸»é¢˜é¢œè‰²æ–¹æ¡ˆ
        const themes = [
            { primary: "#ffb6c1", secondary: "#ffccd5", accent: "#b5e6d9", dark: "#6a4c93" },
            { primary: "#a7d2cb", secondary: "#f2d388", accent: "#c98474", dark: "#874c62" },
            { primary: "#d4a5a5", secondary: "#ffd6a5", accent: "#caffbf", dark: "#9d4edd" },
            { primary: "#b8f2e6", secondary: "#aed9e0", accent: "#ffa69e", dark: "#5e6472" }
        ];
        
        // å¸ƒå±€é…ç½®
        const layouts = [
            { minWidth: "150px", gap: "12px" },
            { minWidth: "180px", gap: "15px" },
            { minWidth: "120px", gap: "10px" }
        ];
        
        // DOMå…ƒç´ 
        const imageGrid = document.getElementById('imageGrid');
        const imageModal = document.getElementById('imageModal');
        const modalImage = document.getElementById('modalImage');
        const closeModal = document.getElementById('closeModal');
        const refreshBtn = document.getElementById('refreshBtn');
        const themeBtn = document.getElementById('themeBtn');
        const layoutBtn = document.getElementById('layoutBtn');
        const loadingIndicator = document.getElementById('loadingIndicator');
        const loadedCountElement = document.getElementById('loadedCount');
        const loadTimeElement = document.getElementById('loadTime');
        
        // åˆå§‹åŒ–é¡µé¢
        document.addEventListener('DOMContentLoaded', function() {
            // åˆ›å»º25ä¸ªå›¾ç‰‡å ä½ç¬¦
            createImagePlaceholders();
            
            // åŠ è½½å›¾ç‰‡
            loadImages();
            
            // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
            refreshBtn.addEventListener('click', loadImages);
            themeBtn.addEventListener('click', changeTheme);
            layoutBtn.addEventListener('click', changeLayout);
            closeModal.addEventListener('click', () => {
                imageModal.style.display = 'none';
            });
            
            // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­
            imageModal.addEventListener('click', (e) => {
                if (e.target === imageModal) {
                    imageModal.style.display = 'none';
                }
            });
        });
        
        // åˆ›å»ºå›¾ç‰‡å ä½ç¬¦
        function createImagePlaceholders() {
            imageGrid.innerHTML = '';
            loadedImages = 0;
            loadedCountElement.textContent = '0';
            loadTimeElement.textContent = '0';
            
            for (let i = 0; i < 25; i++) {
                const imageItem = document.createElement('div');
                imageItem.className = 'image-item loading';
                imageItem.id = `image-${i}`;
                
                const loadingText = document.createElement('div');
                loadingText.className = 'loading-text';
                loadingText.textContent = 'åŠ è½½ä¸­...';
                
                const counter = document.createElement('div');
                counter.className = 'counter';
                counter.textContent = `${i + 1}/25`;
                
                imageItem.appendChild(loadingText);
                imageItem.appendChild(counter);
                
                // æ·»åŠ ç‚¹å‡»äº‹ä»¶
                imageItem.addEventListener('click', () => openImageModal(i));
                
                imageGrid.appendChild(imageItem);
            }
        }
        
        // åŠ è½½å›¾ç‰‡
        function loadImages() {
            // é‡ç½®çŠ¶æ€
            createImagePlaceholders();
            loadingIndicator.style.display = 'block';
            startTime = Date.now();
            imagePromises = [];
            
            // ä¸ºæ¯å¼ å›¾ç‰‡åˆ›å»ºåŠ è½½Promise
            for (let i = 0; i < 25; i++) {
                const promise = loadSingleImage(i);
                imagePromises.push(promise);
            }
            
            // å¹¶è¡ŒåŠ è½½æ‰€æœ‰å›¾ç‰‡ï¼Œè®¾ç½®5ç§’è¶…æ—¶
            const timeoutPromise = new Promise((_, reject) => {
                setTimeout(() => reject(new Error('åŠ è½½è¶…æ—¶')), 5000);
            });
            
            Promise.race([Promise.all(imagePromises), timeoutPromise])
                .then(() => {
                    console.log('æ‰€æœ‰å›¾ç‰‡åŠ è½½å®Œæˆ');
                })
                .catch(error => {
                    console.log('å›¾ç‰‡åŠ è½½é”™è¯¯æˆ–è¶…æ—¶:', error);
                    // å³ä½¿è¶…æ—¶ï¼Œä¹Ÿæ˜¾ç¤ºå·²åŠ è½½çš„å›¾ç‰‡
                })
                .finally(() => {
                    loadingIndicator.style.display = 'none';
                    updateLoadTime();
                });
        }
        
        // åŠ è½½å•å¼ å›¾ç‰‡
        function loadSingleImage(index) {
            return new Promise((resolve) => {
                // éšæœºé€‰æ‹©API
                const apiIndex = Math.floor(Math.random() * imageAPIs.length);
                let imageUrl = imageAPIs[apiIndex];
                
                // ä¸ºæŸäº›APIæ·»åŠ éšæœºå‚æ•°é¿å…ç¼“å­˜
                if (imageUrl.includes('random') || imageUrl.includes('type=')) {
                    imageUrl += `&t=${Date.now()}_${index}`;
                } else if (imageUrl.includes('?')) {
                    imageUrl += `&t=${Date.now()}_${index}`;
                } else {
                    imageUrl += `?t=${Date.now()}_${index}`;
                }
                
                const img = new Image();
                const imageItem = document.getElementById(`image-${index}`);
                
                // è®¾ç½®5ç§’è¶…æ—¶
                const timeoutId = setTimeout(() => {
                    img.src = '';
                    imageItem.innerHTML = '<div class="loading-text">åŠ è½½å¤±è´¥</div>';
                    imageItem.classList.remove('loading');
                    loadedImages++;
                    loadedCountElement.textContent = loadedImages.toString();
                    resolve();
                }, 5000);
                
                img.onload = function() {
                    clearTimeout(timeoutId);
                    imageItem.classList.remove('loading');
                    imageItem.innerHTML = '';
                    
                    // åˆ›å»ºå›¾ç‰‡å…ƒç´ 
                    const imgElement = document.createElement('img');
                    imgElement.src = imageUrl;
                    imgElement.alt = `ç¾å›¾ ${index + 1}`;
                    imgElement.loading = 'lazy'; // æ‡’åŠ è½½
                    
                    // åˆ›å»ºå›¾ç‰‡ä¿¡æ¯
                    const imageInfo = document.createElement('div');
                    imageInfo.className = 'image-info';
                    imageInfo.textContent = `å›¾ç‰‡ ${index + 1}`;
                    
                    // åˆ›å»ºè®¡æ•°å™¨
                    const counter = document.createElement('div');
                    counter.className = 'counter';
                    counter.textContent = `${index + 1}/25`;
                    
                    imageItem.appendChild(imgElement);
                    imageItem.appendChild(imageInfo);
                    imageItem.appendChild(counter);
                    
                    loadedImages++;
                    loadedCountElement.textContent = loadedImages.toString();
                    
                    // æ›´æ–°åŠ è½½æ—¶é—´
                    updateLoadTime();
                    
                    resolve();
                };
                
                img.onerror = function() {
                    clearTimeout(timeoutId);
                    // å¦‚æœåŠ è½½å¤±è´¥ï¼Œå°è¯•å¤‡ç”¨API
                    const fallbackApi = "https://picsum.photos/600/800?random=" + index;
                    const fallbackImg = new Image();
                    
                    fallbackImg.onload = function() {
                        imageItem.classList.remove('loading');
                        imageItem.innerHTML = '';
                        
                        const imgElement = document.createElement('img');
                        imgElement.src = fallbackImg.src;
                        imgElement.alt = `ç¾å›¾ ${index + 1}`;
                        
                        const imageInfo = document.createElement('div');
                        imageInfo.className = 'image-info';
                        imageInfo.textContent = `å›¾ç‰‡ ${index + 1} (å¤‡ç”¨æº)`;
                        
                        const counter = document.createElement('div');
                        counter.className = 'counter';
                        counter.textContent = `${index + 1}/25`;
                        
                        imageItem.appendChild(imgElement);
                        imageItem.appendChild(imageInfo);
                        imageItem.appendChild(counter);
                        
                        loadedImages++;
                        loadedCountElement.textContent = loadedImages.toString();
                        updateLoadTime();
                        resolve();
                    };
                    
                    fallbackImg.onerror = function() {
                        imageItem.innerHTML = '<div class="loading-text">åŠ è½½å¤±è´¥</div>';
                        imageItem.classList.remove('loading');
                        loadedImages++;
                        loadedCountElement.textContent = loadedImages.toString();
                        resolve();
                    };
                    
                    fallbackImg.src = fallbackApi + "&t=" + Date.now();
                };
                
                img.src = imageUrl;
            });
        }
        
        // æ›´æ–°åŠ è½½æ—¶é—´
        function updateLoadTime() {
            if (loadedImages === 25) {
                const loadTime = (Date.now() - startTime) / 1000;
                loadTimeElement.textContent = loadTime.toFixed(2);
            }
        }
        
        // æ‰“å¼€å›¾ç‰‡æ¨¡æ€æ¡†
        function openImageModal(index) {
            const imageItem = document.getElementById(`image-${index}`);
            const img = imageItem.querySelector('img');
            
            if (img && img.src) {
                modalImage.src = img.src;
                modalImage.alt = img.alt;
                imageModal.style.display = 'flex';
            }
        }
        
        // åˆ‡æ¢ä¸»é¢˜
        function changeTheme() {
            currentTheme = (currentTheme + 1) % themes.length;
            const theme = themes[currentTheme];
            
            document.documentElement.style.setProperty('--primary', theme.primary);
            document.documentElement.style.setProperty('--secondary', theme.secondary);
            document.documentElement.style.setProperty('--accent', theme.accent);
            document.documentElement.style.setProperty('--dark', theme.dark);
            
            // æ›´æ–°è£…é¥°å…ƒç´ é¢œè‰²
            document.documentElement.style.setProperty('--cat-color', theme.primary);
            document.documentElement.style.setProperty('--cherry-color', theme.accent);
            
            // æ›´æ–°æŒ‰é’®æ–‡æœ¬
            themeBtn.innerHTML = `<i class="fas fa-palette"></i> ä¸»é¢˜ ${currentTheme + 1}`;
        }
        
        // åˆ‡æ¢å¸ƒå±€
        function changeLayout() {
            currentLayout = (currentLayout + 1) % layouts.length;
            const layout = layouts[currentLayout];
            
            imageGrid.style.gridTemplateColumns = `repeat(auto-fill, minmax(${layout.minWidth}, 1fr))`;
            imageGrid.style.gap = layout.gap;
            
            // æ›´æ–°å›¾ç‰‡é¡¹é«˜åº¦
            const imageItems = document.querySelectorAll('.image-item');
            const minWidth = parseInt(layout.minWidth);
            imageItems.forEach(item => {
                item.style.height = `${minWidth}px`;
            });
            
            // æ›´æ–°æŒ‰é’®æ–‡æœ¬
            layoutBtn.innerHTML = `<i class="fas fa-th-large"></i> å¸ƒå±€ ${currentLayout + 1}`;
        }
        
        // æ·»åŠ é”®ç›˜å¿«æ·é”®æ”¯æŒ
        document.addEventListener('keydown', function(e) {
            // æŒ‰ç©ºæ ¼é”®åˆ·æ–°
            if (e.code === 'Space') {
                e.preventDefault();
                loadImages();
            }
            
            // æŒ‰ESCé”®å…³é—­æ¨¡æ€æ¡†
            if (e.code === 'Escape') {
                imageModal.style.display = 'none';
            }
            
            // æŒ‰Té”®åˆ‡æ¢ä¸»é¢˜
            if (e.code === 'KeyT' && e.ctrlKey) {
                e.preventDefault();
                changeTheme();
            }
        });
        
        // æ·»åŠ ä¸‹æ‹‰åˆ·æ–°æ”¯æŒï¼ˆç§»åŠ¨ç«¯ï¼‰
        let touchStartY = 0;
        document.addEventListener('touchstart', function(e) {
            touchStartY = e.touches[0].clientY;
        });
        
        document.addEventListener('touchmove', function(e) {
            const touchY = e.touches[0].clientY;
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            
            // å¦‚æœç”¨æˆ·åœ¨é¡¶éƒ¨ä¸‹æ‹‰
            if (scrollTop === 0 && touchY > touchStartY + 100) {
                loadImages();
            }
        });
        
        // åˆå§‹åŠ è½½å®Œæˆåï¼Œéšæœºåˆ‡æ¢ä¸€æ¬¡ä¸»é¢˜å’Œå¸ƒå±€
        setTimeout(() => {
            currentTheme = Math.floor(Math.random() * themes.length);
            changeTheme();
            
            currentLayout = Math.floor(Math.random() * layouts.length);
            changeLayout();
        }, 1000);
    </script>
</body>
</html>
