<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>geminiå†™çš„ | 'Sora Gallery Ultimate</title>
    <style>
        /* =========================================
           1. å…¨å±€å˜é‡å®šä¹‰ (CSS Variables)
           ========================================= */
        :root {
            /* é…è‰²æ–¹æ¡ˆï¼šé©¬å¡é¾™è‰²ç³» */
            --bg-color: #fff5f7;
            --primary: #ff9a9e;     /* æ¨±èŠ±ç²‰ */
            --primary-dark: #ff758c;
            --secondary: #a18cd1;   /* æ¢¦å¹»ç´« */
            --accent: #fbc2eb;      /* æµ…ç´«ç²‰ */
            --yellow: #fad0c4;      /* å¥¶æ²¹é»„ */
            --text-main: #555555;
            --text-light: #888888;
            --card-bg: #ffffff;
            
            /* å¸ƒå±€å‚æ•° */
            --gap: 12px;
            --radius: 16px;
            --header-height: 60px;
            
            /* é˜´å½±ä¸ç‰¹æ•ˆ */
            --shadow-sm: 0 4px 12px rgba(255, 154, 158, 0.2);
            --shadow-hover: 0 10px 25px rgba(161, 140, 209, 0.3);
            --glass: rgba(255, 255, 255, 0.85);
            --glass-blur: blur(12px);
        }

        /* =========================================
           2. åŸºç¡€é‡ç½®ä¸æ’ç‰ˆ (Reset & Typography)
           ========================================= */
        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            outline: none;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Nunito', 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background: var(--bg-color);
            background-image: 
                linear-gradient(120deg, #fccb90 0%, #d57eeb 100%);
            background-attachment: fixed; /* èƒŒæ™¯å›ºå®š */
            color: var(--text-main);
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: rgba(255,255,255,0.3); }
        ::-webkit-scrollbar-thumb { 
            background: var(--primary); 
            border-radius: 10px; 
        }

        /* =========================================
           3. æ ¸å¿ƒå¸ƒå±€ (Layout)
           ========================================= */
        
        /* ğŸŒ¸ èƒŒæ™¯ Canvas */
        #particle-canvas {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: -1;
            pointer-events: none;
        }

        /* ğŸ  é¡¶éƒ¨å¯¼èˆªæ  */
        .app-header {
            position: fixed;
            top: 0; left: 0; right: 0;
            height: var(--header-height);
            background: var(--glass);
            backdrop-filter: var(--glass-blur);
            -webkit-backdrop-filter: var(--glass-blur);
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.05);
            transition: transform 0.3s;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .app-title {
            font-size: 1.1rem;
            font-weight: 800;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 0.5px;
        }

        /* â˜• åŠ¨æ€å’–å•¡æ¯ Logo */
        .coffee-logo {
            width: 24px; height: 20px;
            position: relative;
        }
        .cup-body {
            width: 100%; height: 100%;
            background: var(--primary);
            border-radius: 0 0 12px 12px;
            position: relative;
        }
        .cup-handle {
            position: absolute;
            top: 4px; right: -6px;
            width: 8px; height: 10px;
            border: 2px solid var(--primary);
            border-radius: 0 50% 50% 0;
        }
        .steam {
            position: absolute; width: 4px; height: 6px;
            background: #fff; border-radius: 50%;
            opacity: 0; animation: rise 2s infinite;
        }
        .steam:nth-child(1) { left: 5px; animation-delay: 0s; }
        .steam:nth-child(2) { left: 15px; animation-delay: 1s; }
        @keyframes rise {
            0% { transform: translateY(-5px); opacity: 0.8; }
            100% { transform: translateY(-18px); opacity: 0; }
        }

        /* ğŸ”„ åˆ·æ–°æŒ‰é’® */
        .btn-refresh {
            background: white;
            border: 2px solid var(--primary);
            color: var(--primary);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            box-shadow: var(--shadow-sm);
            transition: all 0.2s;
        }
        .btn-refresh:active { transform: scale(0.92); }
        .icon-spin { animation: spin 1s linear infinite; }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        /* =========================================
           4. ç€‘å¸ƒæµå®¹å™¨ (Masonry Grid)
           ========================================= */
        .gallery-wrapper {
            margin-top: calc(var(--header-height) + 10px);
            padding: 10px;
            column-count: 2; /* é»˜è®¤åŒåˆ— */
            column-gap: var(--gap);
            min-height: 100vh;
        }
        
        @media (min-width: 640px) { .gallery-wrapper { column-count: 3; max-width: 900px; margin-left: auto; margin-right: auto; } }
        @media (min-width: 1024px) { .gallery-wrapper { column-count: 4; max-width: 1200px; } }

        .card {
            background: var(--card-bg);
            border-radius: var(--radius);
            margin-bottom: var(--gap);
            overflow: hidden;
            break-inside: avoid; /* é˜²æ­¢æ–­è£‚ */
            box-shadow: var(--shadow-sm);
            transform: translateY(20px);
            opacity: 0;
            animation: fadeUp 0.6s cubic-bezier(0.165, 0.84, 0.44, 1) forwards;
            position: relative;
            transition: transform 0.2s;
        }
        
        @keyframes fadeUp { to { opacity: 1; transform: translateY(0); } }
        
        .card:active { transform: scale(0.98); }

        .img-container {
            position: relative;
            background: #eee;
            overflow: hidden;
        }

        /* éª¨æ¶å±åŠ¨ç”» - ä¼˜åŒ–ç‰ˆ */
        .skeleton {
            background: linear-gradient(110deg, #ececec 8%, #f5f5f5 18%, #ececec 33%);
            background-size: 200% 100%;
            animation: shimmer 1.5s linear infinite;
        }
        @keyframes shimmer { 
            0% { background-position-x: 100%; } 
            100% { background-position-x: -100%; } 
        }

        .card-img {
            display: block;
            width: 100%;
            height: auto;
            opacity: 0;
            transition: opacity 0.4s ease-in, transform 0.5s ease;
            object-fit: cover;
        }
        .card-img.loaded { opacity: 1; }
        
        /* æ ‡ç­¾ Badge */
        .card-badge {
            position: absolute;
            top: 8px; left: 8px;
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(4px);
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.7rem;
            color: var(--primary);
            font-weight: 800;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            z-index: 2;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        /* æ¨¡æ‹Ÿåº•éƒ¨ä¿¡æ¯æ  */
        .card-info {
            padding: 8px 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #fff;
        }
        .like-box {
            display: flex; align-items: center; gap: 4px;
            color: var(--primary); font-size: 0.8rem; font-weight: bold;
        }
        .author-name {
            font-size: 0.7rem; color: #999;
        }

        /* =========================================
           5. å¤§å›¾æŸ¥çœ‹å™¨ (Lightbox)
           ========================================= */
        .lightbox {
            position: fixed; inset: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            z-index: 2000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            opacity: 0; pointer-events: none;
            transition: opacity 0.3s;
        }
        .lightbox.active { opacity: 1; pointer-events: auto; }

        .lb-img-wrapper {
            position: relative;
            max-width: 95%; max-height: 80%;
            border-radius: 12px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.15);
            overflow: hidden;
            transform: scale(0.9);
            transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        .lightbox.active .lb-img-wrapper { transform: scale(1); }

        .lb-img {
            max-width: 100%; max-height: 80vh;
            display: block;
        }

        .lb-actions {
            margin-top: 20px;
            display: flex; gap: 20px;
        }
        .action-btn {
            width: 50px; height: 50px;
            border-radius: 50%;
            border: none;
            background: white;
            color: var(--primary);
            font-size: 1.2rem;
            box-shadow: 0 5px 15px rgba(255, 154, 158, 0.3);
            display: flex; align-items: center; justify-content: center;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .action-btn:active { transform: scale(0.9); }
        .close-btn {
            position: absolute; top: 20px; right: 20px;
            background: #eee; width: 40px; height: 40px;
            border-radius: 50%; border: none; font-size: 1.5rem; color: #555;
        }

        /* =========================================
           6. è£…é¥°æ€§ç»„ä»¶ (Widgets)
           ========================================= */
        
        /* ğŸ± æ‚¬æµ®çŒ«å’ª */
        .neko-float {
            position: fixed; bottom: 20px; right: 20px;
            width: 64px; height: 64px;
            z-index: 900; cursor: pointer;
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.1));
            transition: transform 0.3s;
        }
        .neko-float:hover { transform: translateY(-5px) rotate(5deg); }
        .neko-float svg { width: 100%; height: 100%; }
        
        .chat-bubble {
            position: absolute; bottom: 70px; right: 10px;
            background: #fff; padding: 10px 14px;
            border-radius: 16px 16px 2px 16px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            font-size: 0.85rem; color: #555;
            width: max-content; max-width: 180px;
            opacity: 0; transform: scale(0.8);
            transform-origin: bottom right;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            pointer-events: none;
        }
        .chat-bubble.show { opacity: 1; transform: scale(1); }

        /* Toast æç¤º */
        .toast {
            position: fixed; top: 80px; left: 50%;
            transform: translateX(-50%) translateY(-20px);
            background: rgba(0,0,0,0.7);
            color: white; padding: 10px 20px;
            border-radius: 30px; font-size: 0.9rem;
            opacity: 0; pointer-events: none;
            transition: all 0.3s; z-index: 3000;
        }
        .toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }

    </style>
</head>
<body>

    <!-- Canvas èƒŒæ™¯ -->
    <canvas id="particle-canvas"></canvas>

    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <header class="app-header">
        <div class="header-left">
            <div class="coffee-logo">
                <div class="steam"></div><div class="steam"></div>
                <div class="cup-body"><div class="cup-handle"></div></div>
            </div>
            <div class="app-title">sora Gallery</div>
        </div>
        <button class="btn-refresh" onclick="app.refreshAll()">
            <span id="refresh-icon">â†»</span> æ¢ä¸€æ‰¹
        </button>
    </header>

    <!-- å›¾ç‰‡å±•ç¤ºåŒº -->
    <main class="gallery-wrapper" id="gallery-grid">
        <!-- JS åŠ¨æ€ç”Ÿæˆ -->
    </main>

    <!-- æ‚¬æµ®çŒ«å’ª -->
    <div class="neko-float" onclick="app.interactCat()">
        <div class="chat-bubble" id="cat-msg">æ¬¢è¿ä¸»äººå›å®¶å–µï¼âœ¨</div>
        <!-- å†…è” SVG çŒ«å’ª -->
        <svg viewBox="0 0 512 512">
            <g>
                <path fill="#FFC0CB" d="M414.4 97.6c-22.3-22.3-54.8-30.8-84.7-24.9l-22.3-56.5c-2.5-6.3-8.6-10.5-15.4-10.5h-71.9c-6.8 0-12.9 4.1-15.4 10.5l-22.3 56.5c-30-5.9-62.4 2.6-84.7 24.9-34.4 34.3-49.2 91.2-40.5 151.3l-29.1 73.8c-3.8 9.6-.9 20.6 6.7 27.1l51.5 43.9c5.9 5 14.1 5.6 20.5 1.4l44-28.3c32.7 19.2 70.5 29.5 109.1 29.5s76.4-10.2 109.1-29.5l44 28.3c6.5 4.1 14.7 3.6 20.5-1.4l51.5-43.9c7.6-6.5 10.5-17.5 6.7-27.1l-29.1-73.8c8.7-60.1-6-117-40.4-151.3z"/>
                <path fill="#FFFFFF" d="M130 180c0-11 9-20 20-20s20 9 20 20v20c0 11-9 20-20 20s-20-9-20-20v-20z"/>
                <path fill="#FFFFFF" d="M342 180c0-11 9-20 20-20s20 9 20 20v20c0 11-9 20-20 20s-20-9-20-20v-20z"/>
                <circle fill="#333" cx="150" cy="190" r="12"/>
                <circle fill="#333" cx="362" cy="190" r="12"/>
                <ellipse fill="#FF69B4" cx="256" cy="270" rx="20" ry="14"/>
            </g>
        </svg>
    </div>

    <!-- Lightbox -->
    <div class="lightbox" id="lightbox">
        <button class="close-btn" onclick="app.closeLightbox()">Ã—</button>
        <div class="lb-img-wrapper">
            <img class="lb-img" id="lb-image" src="" alt="">
        </div>
        <div class="lb-actions">
            <button class="action-btn" onclick="app.downloadImage()">â¬‡</button>
            <button class="action-btn" onclick="app.toast('å·²æ”¶è—åˆ°å–œæ¬¢åˆ—è¡¨ â¤ï¸')">â¤ï¸</button>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast">æç¤ºä¿¡æ¯</div>

    <!-- JS é€»è¾‘ -->
    <script>
        /**
         * âœ¨ Neko Gallery Ultimate Engine
         * åŒ…å«ï¼š
         * 1. Hybrid Image Loader (æ··åˆåŠ è½½å™¨)
         * 2. Physics Particle System (ç²’å­ç³»ç»Ÿ)
         * 3. Interactive UI Manager (äº¤äº’ç®¡ç†)
         */

        const app = {
            state: {
                isFetching: false,
                cols: 2
            },
            config: {
                // API é…ç½® - ä¿è¯é€Ÿåº¦å’Œè´¨é‡
                // 3D: Lorem Picsum Seed (ç§’å¼€)
                // 2D: Waifu.im (æ”¯æŒæ‰¹é‡ï¼Œé€Ÿåº¦å¿«)
                api2D: 'https://api.waifu.im/search?included_tags=waifu&is_nsfw=false&many=true',
                totalImages: 20
            },

            // ğŸŸ¢ åˆå§‹åŒ–
            init() {
                this.setupParticles();
                this.loadGallery();
                this.setupResizeListener();
            },

            // ğŸš€ æ ¸å¿ƒåŠ è½½é€»è¾‘ï¼šåˆ†æ­¥æ¸²æŸ“ï¼Œæé€Ÿä½“éªŒ
            async loadGallery() {
                if (this.state.isFetching) return;
                this.state.isFetching = true;
                
                const grid = document.getElementById('gallery-grid');
                const btnIcon = document.getElementById('refresh-icon');
                
                // 1. UI çŠ¶æ€é‡ç½®
                window.scrollTo({ top: 0, behavior: 'smooth' });
                btnIcon.classList.add('icon-spin');
                grid.innerHTML = ''; // æ¸…ç©º

                // 2. ç”Ÿæˆæ•°æ®å ä½ç¬¦
                // æˆ‘ä»¬ä¸ç­‰å¾… APIï¼Œç›´æ¥ç”Ÿæˆ 20 ä¸ª slot
                // å¶æ•°ç´¢å¼• = 3D (Picsum, æ— éœ€è¯·æ±‚ï¼Œç›´æ¥ç”Ÿæˆé“¾æ¥)
                // å¥‡æ•°ç´¢å¼• = 2D (Waifu, éœ€è¦è¯·æ±‚ï¼Œå…ˆæ”¾éª¨æ¶å±)
                
                const slots = [];
                const seed = Date.now();
                
                for(let i=0; i<this.config.totalImages; i++) {
                    const is2D = i % 2 !== 0; // æ··æ’
                    const slotId = `slot-${i}`;
                    
                    // åˆ›å»ºå¡ç‰‡å®¹å™¨
                    const card = document.createElement('div');
                    card.className = 'card';
                    card.style.animationDelay = `${i * 0.05}s`; // ç€‘å¸ƒæµè¿›åœºåŠ¨ç”»
                    
                    // éšæœºé«˜åº¦æ¯” (æ¨¡æ‹Ÿç€‘å¸ƒæµ)
                    const aspect = is2D ? 140 : (Math.random() > 0.5 ? 130 : 100); 
                    
                    // å¡«å……éª¨æ¶ç»“æ„
                    card.innerHTML = `
                        <div class="img-container skeleton" style="padding-bottom: ${aspect}%">
                            <img id="${slotId}" class="card-img" 
                                 onclick="app.openLightbox(this.dataset.full)" 
                                 alt="Loading..."
                            >
                            <div class="card-badge">
                                ${is2D ? 'ğŸŒ¸ äºŒæ¬¡å…ƒ' : 'ğŸ“· æ‘„å½±'}
                            </div>
                        </div>
                        <div class="card-info">
                            <div class="like-box">â¤ï¸ ${Math.floor(Math.random()*900)+100}</div>
                            <div class="author-name">@${is2D ? 'AnimeArt' : 'Unsplash'}</div>
                        </div>
                    `;
                    grid.appendChild(card);
                    
                    // 3. å¤„ç† 3D å›¾ç‰‡ (ç«‹åˆ»æ˜¾ç¤ºï¼)
                    if (!is2D) {
                        const w = 600;
                        const h = Math.floor(w * (aspect/100));
                        const imgEl = card.querySelector('img');
                        // æŠ€å·§ï¼šPicsum Seed é“¾æ¥æ˜¯ç¬é—´ç”Ÿæˆçš„
                        const src = `https://picsum.photos/seed/${seed+i}/${w}/${h}`;
                        const full = `https://picsum.photos/seed/${seed+i}/1200/1600`;
                        
                        imgEl.src = src;
                        imgEl.dataset.full = full;
                        imgEl.onload = () => {
                            imgEl.classList.add('loaded');
                            imgEl.parentElement.classList.remove('skeleton');
                        };
                    } else {
                        // è®°å½•éœ€è¦å¡«å……çš„ 2D å‘ä½
                        slots.push({ elId: slotId, aspect: aspect });
                    }
                }

                // 4. å¼‚æ­¥åŠ è½½ 2D å›¾ç‰‡ (ä¸é˜»å¡ 3D æ˜¾ç¤º)
                try {
                    const res = await fetch(this.config.api2D);
                    const data = await res.json();
                    
                    if(data.images) {
                        // å¡«å‘
                        slots.forEach((slot, index) => {
                            if(data.images[index]) {
                                const imgData = data.images[index];
                                const imgEl = document.getElementById(slot.elId);
                                if(imgEl) {
                                    imgEl.src = imgData.url;
                                    imgEl.dataset.full = imgData.url;
                                    imgEl.onload = () => {
                                        imgEl.classList.add('loaded');
                                        imgEl.parentElement.classList.remove('skeleton');
                                    };
                                }
                            }
                        });
                    }
                } catch (e) {
                    console.error('2D API Error, falling back to backup');
                    // é™çº§æ–¹æ¡ˆï¼šå¦‚æœ Waifu API æŒ‚äº†ï¼Œç”¨ Nekos Best è¡¥å……
                    this.fillBackupImages(slots);
                }

                // 5. ç»“æŸåŠ è½½çŠ¶æ€
                setTimeout(() => {
                    this.state.isFetching = false;
                    btnIcon.classList.remove('icon-spin');
                    this.toast('å·²ä¸ºæ‚¨å‘ˆç°æœ€æ–°ç²¾é€‰ âœ¨');
                }, 800);
            },

            // å¤‡ç”¨å¡«å……æ–¹æ¡ˆ (ä¿è¯ä¸ç•™ç™½)
            async fillBackupImages(slots) {
                // ä½¿ç”¨ Nekos.best
                try {
                    const res = await fetch(`https://nekos.best/api/v2/waifu?amount=${slots.length}`);
                    const data = await res.json();
                    slots.forEach((slot, index) => {
                        if(data.results[index]) {
                            const imgEl = document.getElementById(slot.elId);
                            imgEl.src = data.results[index].url;
                            imgEl.dataset.full = data.results[index].url;
                            imgEl.onload = () => {
                                imgEl.classList.add('loaded');
                                imgEl.parentElement.classList.remove('skeleton');
                            }
                        }
                    });
                } catch(e) {
                    // æœ€åçš„ä¿åº•ï¼šå…¨æ¢æˆ Picsum
                    slots.forEach((slot, i) => {
                        const imgEl = document.getElementById(slot.elId);
                        imgEl.src = `https://picsum.photos/seed/backup${i}/600/800`;
                        imgEl.classList.add('loaded');
                    });
                }
            },

            // ğŸ”„ åˆ·æ–°
            refreshAll() {
                this.loadGallery();
            },

            // ğŸ” Lightbox é€»è¾‘
            openLightbox(src) {
                if(!src) return;
                const lb = document.getElementById('lightbox');
                const img = document.getElementById('lb-image');
                img.src = src;
                lb.classList.add('active');
            },
            closeLightbox() {
                document.getElementById('lightbox').classList.remove('active');
            },
            downloadImage() {
                const src = document.getElementById('lb-image').src;
                const a = document.createElement('a');
                a.href = src;
                a.download = 'neko_gallery_img.jpg';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                this.toast('å¼€å§‹ä¸‹è½½å›¾ç‰‡... â¬‡ï¸');
            },

            // ğŸ’¬ äº¤äº’åé¦ˆ
            interactCat() {
                const msgs = [
                    "ä¸è¦æ‘¸é‚£é‡Œå•¦ï¼>_<", 
                    "åˆ·æ–°ä¸€ä¸‹æœ‰æ–°è€å©†å“¦ï¼", 
                    "ä»Šå¤©çš„å’–å•¡å¾ˆé¦™å‘¢ â˜•", 
                    "å–µå‘œ~ è¹­è¹­ä½  â¤ï¸", 
                    "è¿™æ˜¯ä¸ºä½ æŒ‘é€‰çš„ç¾å›¾ï¼"
                ];
                const bubble = document.getElementById('cat-msg');
                bubble.innerText = msgs[Math.floor(Math.random() * msgs.length)];
                bubble.classList.add('show');
                
                // æ‰‹æœºéœ‡åŠ¨
                if(navigator.vibrate) navigator.vibrate([50, 50, 50]);
                
                setTimeout(() => bubble.classList.remove('show'), 2000);
            },

            toast(msg) {
                const t = document.getElementById('toast');
                t.innerText = msg;
                t.classList.add('show');
                setTimeout(() => t.classList.remove('show'), 2000);
            },

            setupResizeListener() {
                // ç›‘å¬çª—å£å¤§å°å˜åŒ–ä»¥é‡ç»˜ Canvas
                window.addEventListener('resize', () => {
                    this.initCanvasSize();
                });
            },
            
            initCanvasSize() {}, // Placeholder

            // âœ¨ ç²’å­ç³»ç»Ÿ (æ¨±èŠ± + æ˜Ÿæ˜Ÿ)
            setupParticles() {
                const canvas = document.getElementById('particle-canvas');
                const ctx = canvas.getContext('2d');
                let w, h;
                const particles = [];
                
                // å®šä¹‰ç²’å­ç±»å‹
                const TYPES = ['circle', 'sakura', 'star'];

                this.initCanvasSize = () => {
                    w = canvas.width = window.innerWidth;
                    h = canvas.height = window.innerHeight;
                };
                this.initCanvasSize();

                class Particle {
                    constructor() { this.reset(); }
                    reset() {
                        this.x = Math.random() * w;
                        this.y = Math.random() * h;
                        this.size = Math.random() * 5 + 2;
                        this.speedX = Math.random() * 0.5 - 0.25;
                        this.speedY = Math.random() * 0.5 + 0.2;
                        this.type = TYPES[Math.floor(Math.random() * TYPES.length)];
                        this.rotation = Math.random() * 360;
                        this.spin = Math.random() * 2 - 1;
                        this.opacity = Math.random() * 0.4 + 0.1;
                        this.color = Math.random() > 0.5 ? '#ff9a9e' : '#a18cd1';
                    }
                    update() {
                        this.y += this.speedY;
                        this.x += this.speedX;
                        this.rotation += this.spin;
                        if(this.y > h + 10) {
                            this.y = -10;
                            this.x = Math.random() * w;
                        }
                    }
                    draw() {
                        ctx.save();
                        ctx.translate(this.x, this.y);
                        ctx.rotate(this.rotation * Math.PI / 180);
                        ctx.globalAlpha = this.opacity;
                        ctx.fillStyle = this.color;

                        if (this.type === 'circle') {
                            ctx.beginPath();
                            ctx.arc(0, 0, this.size/2, 0, Math.PI*2);
                            ctx.fill();
                        } else if (this.type === 'sakura') {
                            // ç»˜åˆ¶ç®€å•çš„èŠ±ç“£
                            ctx.beginPath();
                            ctx.moveTo(0,0);
                            ctx.bezierCurveTo(this.size, -this.size/2, this.size, this.size/2, 0, this.size);
                            ctx.bezierCurveTo(-this.size, this.size/2, -this.size, -this.size/2, 0, 0);
                            ctx.fill();
                        } else if (this.type === 'star') {
                            // ç®€å•çš„åå­—æ˜Ÿ
                            ctx.fillRect(-this.size/2, -1, this.size, 2);
                            ctx.fillRect(-1, -this.size/2, 2, this.size);
                        }
                        ctx.restore();
                    }
                }

                // åˆ›å»º 50 ä¸ªç²’å­
                for(let i=0; i<50; i++) particles.push(new Particle());

                const animate = () => {
                    ctx.clearRect(0, 0, w, h);
                    particles.forEach(p => {
                        p.update();
                        p.draw();
                    });
                    requestAnimationFrame(animate);
                };
                animate();
            }
        };

        // å¯åŠ¨åº”ç”¨
        document.addEventListener('DOMContentLoaded', () => app.init());

    </script>
</body>
</html>
